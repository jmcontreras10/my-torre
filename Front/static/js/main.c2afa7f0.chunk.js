(this["webpackJsonptorre-react-webapp"]=this["webpackJsonptorre-react-webapp"]||[]).push([[0],{10:function(e,t,r){e.exports={anim:"LoadingIndicator_anim__2Bal1",animatespin:"LoadingIndicator_animatespin__3IWv1"}},17:function(e,t,r){},18:function(e,t,r){"use strict";r.r(t);var n=r(0),a=r(1),s=r.n(a),c=r(9),o=r.n(c),u=r(2),i=r.n(u),l=r(4),p=r(5),d="http://localhost:3001/api",b={"Content-Type":"application/json","Access-Control-Allow-Origin":"*"},h=function(){var e=Object(l.a)(i.a.mark((function e(){var t,r,n,a,s,c,o,u=arguments;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=u.length>0&&void 0!==u[0]?u[0]:{path:"/",queries:{},method:"GET",body:void 0,headers:b,redirect:"follow"},r=new URL("".concat(d).concat(t.path)),t.queries)for(n=0,a=Object.keys(t.queries);n<a.length;n++)s=a[n],r.searchParams.append(s,t.queries[s]);return t.body&&(t.body=JSON.stringify(t.body)),e.next=6,fetch(r.toString(),t);case 6:return c=e.sent,e.next=9,c.json();case 9:return o=e.sent,e.abrupt("return",o);case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),j=Object(a.createContext)(),m=Object(a.createContext)(),f=function(){return Object(a.useContext)(m)},O=function(e){var t=e.children,r=Object(a.useState)({}),s=Object(p.a)(r,2),c=s[0],o=s[1],u=function(){var e=Object(l.a)(i.a.mark((function e(t,r){var n,a,s;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n={path:"/auth/login",method:"POST",body:{username:t,password:r},headers:{"Content-Type":"application/json"}},e.next=4,h(n);case 4:if(1400!==(null===(a=e.sent)||void 0===a?void 0:a.internalCode)){e.next=7;break}throw a;case 7:return s={username:a.user.username},sessionStorage.setItem("JWTtorreJobsToken",a.token),sessionStorage.setItem("torreSocialUsername",a.user.username),o(s),e.abrupt("return",!0);case 14:throw e.prev=14,e.t0=e.catch(0),e.t0;case 17:case"end":return e.stop()}}),e,null,[[0,14]])})));return function(t,r){return e.apply(this,arguments)}}(),d=function(){var e=Object(l.a)(i.a.mark((function e(t,r){var n,a,s;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n={path:"/auth",method:"POST",body:{username:t,password:r},headers:{"Content-Type":"application/json"}},e.next=4,h(n);case 4:if(1201===(null===(a=e.sent)||void 0===a?void 0:a.internalCode)){e.next=7;break}throw a;case 7:return s={username:a.data.username},sessionStorage.setItem("JWTtorreJobsToken",a.data.token),sessionStorage.setItem("torreSocialUsername",t),o(s),e.abrupt("return",!0);case 14:throw e.prev=14,e.t0=e.catch(0),e.t0;case 17:case"end":return e.stop()}}),e,null,[[0,14]])})));return function(t,r){return e.apply(this,arguments)}}(),b=function(){var e=Object(l.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t={path:"/auth/logout",method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(sessionStorage.getItem("JWTtorreJobsToken"))}},e.next=4,h(t);case 4:sessionStorage.removeItem("JWTtorreJobsToken"),sessionStorage.removeItem("torreSocialUsername"),o({}),e.next=12;break;case 9:throw e.prev=9,e.t0=e.catch(0),e.t0;case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}();return Object(n.jsx)(j.Provider,{value:{userData:c},children:Object(n.jsx)(m.Provider,{value:{register:d,login:u,logout:b},children:t})})},x=Object(a.createContext)(),g=Object(a.createContext)(),v=function(){return Object(a.useContext)(x)},w=function(){return Object(a.useContext)(g)},y=function(e){var t=e.children,r=Object(a.useState)(0),s=Object(p.a)(r,2),c=s[0],o=s[1],u=Object(a.useState)(!1),i=Object(p.a)(u,2),l=i[0],d=i[1];return Object(a.useEffect)((function(){o(sessionStorage.getItem("JWTtorreJobsToken")?1:0)}),[]),Object(n.jsx)(x.Provider,{value:{screen:c,setScreen:o},children:Object(n.jsx)(g.Provider,{value:{globalLoading:l,setGlobalLoading:d},children:t})})},S=Object(a.createContext)(),T=function(){return Object(a.useContext)(S)},C=function(e){var t=e.children,r=Object(a.useState)([]),s=Object(p.a)(r,2),c=s[0],o=s[1];Object(a.useEffect)((function(){var e=sessionStorage.getItem("JWTtorreJobsToken"),t=sessionStorage.getItem("torreSocialUsername");if(t){var r={path:"/social/close/".concat(t),method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)}};h(r).then((function(e){o(e.data)})).catch((function(e){console.log(e)}))}}),[]);var u=function(){var e=Object(l.a)(i.a.mark((function e(){var t,r,n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{t=sessionStorage.getItem("JWTtorreJobsToken"),(r=sessionStorage.getItem("torreSocialUsername"))&&(n={path:"/social/close/".concat(r),method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)}},h(n).then((function(e){console.log(JSON.stringify(e.data)),o(e.data)})).catch((function(e){console.log(e)})))}catch(a){console.log(a)}case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(n.jsx)(S.Provider,{value:{closePeople:c,loadClosePeople:u},children:t})},k=r(3),N=r(10),I=r.n(N),_=function(e){return Object(n.jsx)("button",{type:"button",className:"bg-rose-600 m-auto mb-6 bg-",disabled:!0,children:Object(n.jsx)("div",{className:"animate-spin h-10 w-10 mr-3 ".concat(I.a.anim," m-auto"),viewBox:"0 0 24 24"})})},E=r(6),G=r.n(E),R={authState:0,buttonText:"Continue",authMessage:"Do you have a Torre account?",inputErrorsMessage:void 0,error:!1,loading:!1,userInfo:void 0,correctMatch:!0},J=function(e,t){switch(t.type){case"GO_BEGINING":return R;case"GO_LOGIN":return Object(k.a)(Object(k.a)({},e),{},{authState:1,authMessage:"Cool, login to start",buttonText:"Login",loading:!1,correctMatch:!0});case"GO_REGISTER":return Object(k.a)(Object(k.a)({},e),{},{authState:2,authMessage:"You don't have an account yet, please register",buttonText:"Register",loading:!1,correctMatch:!1});case"GO_TORRE":return Object(k.a)(Object(k.a)({},e),{},{authState:3,authMessage:"You don't have a Torre account yet, please register in the link below",error:!0,loading:!1});case"GO_ERROR":return Object(k.a)(Object(k.a)({},e),{},{authMessage:t.message,error:!0,loading:!1});case"LOADING":return Object(k.a)(Object(k.a)({},e),{},{loading:!0});case"VERIFY":return Object(k.a)(Object(k.a)({},e),{},{inputErrorsMessage:t.message,correctMatch:t.value});default:throw new Error}},P=function(){var e=Object(a.useState)({username:"",password:""}),t=Object(p.a)(e,2),r=t[0],s=t[1],c=f(),o=c.login,u=c.register,d=v().setScreen,b=w().setGlobalLoading,j=T().loadClosePeople,m=Object(a.useReducer)(J,R),O=Object(p.a)(m,2),x=O[0],g=O[1],y=function(){var e=Object(l.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,g({type:"LOADING"}),e.next=4,h({path:"/auth/val/".concat(r.username)});case 4:200===(t=e.sent).code?g({type:"GO_LOGIN"}):1001===t.code?g({type:"GO_REGISTER"}):1e3===t.code&&g({type:"GO_TORRE"}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),g({type:"GO_ERROR",message:e.t0.message});case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}(),S=function(){var e=Object(l.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,b(!0),e.next=4,o(r.username,r.password);case 4:return e.next=6,j();case 6:d(sessionStorage.getItem("JWTtorreJobsToken")?1:0),b(!1),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(0),b(!1),g({type:"GO_ERROR",message:e.t0.message});case 14:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(){return e.apply(this,arguments)}}(),C=function(){var e=Object(l.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,b(!0),e.next=4,u(r.username,r.password);case 4:return e.next=6,j();case 6:d(sessionStorage.getItem("JWTtorreJobsToken")?1:0),b(!1),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(0),b(!1),g({type:"GO_ERROR",message:e.t0.message});case 14:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(){return e.apply(this,arguments)}}(),N=function(){var e=Object(l.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),e.t0=x.authState,e.next=0===e.t0?4:1===e.t0?7:2===e.t0?10:13;break;case 4:return e.next=6,y();case 6:return e.abrupt("break",14);case 7:return e.next=9,S();case 9:return e.abrupt("break",14);case 10:return e.next=12,C();case 12:return e.abrupt("break",14);case 13:return e.abrupt("return");case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(n.jsx)("div",{children:Object(n.jsx)("div",{className:"bg-secondary p-12 color-white ".concat(G.a.AuthCard),children:Object(n.jsxs)("div",{className:"w-auto flex justify-center flex-col text-center",children:[x.authState>0&&Object(n.jsx)("span",{className:"w-full flex justify-start mb-10",children:Object(n.jsx)("button",{className:"underline",onClick:function(e){e.preventDefault(),g({type:"GO_BEGINING"})},children:"Back"})}),Object(n.jsx)("img",{src:"https://torre-media.s3-us-west-2.amazonaws.com/organizations/Torre+(generic)+-+Dark+icon+-+Lime+(x2).png",className:"object-contain h-28 w-full mb-5",alt:"Torre co"}),Object(n.jsx)("h1",{className:"text-2xl mb-5",children:"Torre Jobs"}),Object(n.jsxs)("div",{className:"flex flex-col",children:[Object(n.jsx)("p",{className:"mb-3 ".concat(x.error&&"text-red-500"),children:x.authMessage}),Object(n.jsx)("p",{className:"mb-3 text-red-500",children:x.inputErrorsMessage&&x.inputErrorsMessage}),Object(n.jsx)("input",{type:"text",placeholder:"username",autoComplete:"off",className:G.a.basicInput,onChange:function(e){s(Object(k.a)(Object(k.a)({},r),{},{username:e.target.value}))},disabled:3===x.authState}),(1===x.authState||2===x.authState)&&Object(n.jsx)("input",{type:"password",placeholder:"password",autoComplete:"off",className:G.a.basicInput,onChange:function(e){s(Object(k.a)(Object(k.a)({},r),{},{password:e.target.value})),r.password.length<7?g({type:"VERIFY",value:!1,message:"Password must be longer than 7"}):g({type:"VERIFY",value:!0,message:void 0})},required:!0}),2===x.authState&&Object(n.jsx)("input",{type:"password",placeholder:"repeat password",autoComplete:"off",className:G.a.basicInput,onChange:function(e){e.target.value!==r.password?g({type:"VERIFY",value:!1,message:"Passwords not match"}):g({type:"VERIFY",value:!0,message:void 0})},required:!0}),x.loading?Object(n.jsx)(_,{}):Object(n.jsx)("button",{className:G.a.continueButton,onClick:N,disabled:3===x.authState||!x.correctMatch,children:x.buttonText}),Object(n.jsx)("a",{href:"https://www.torre.co/",target:"_blank",className:"mt-5 underline ",rel:"noreferrer",children:"Create one"})]})]})})})},L=function(){return Object(n.jsx)("main",{className:"flex h-screen w-screen bg-onTerceary font-sans text-white",children:Object(n.jsx)("div",{className:"m-auto",children:Object(n.jsx)(P,{})})})},M=function(){var e=v().setScreen,t=f().logout,r=w().setGlobalLoading,a=function(){var n=Object(l.a)(i.a.mark((function n(){return i.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,r(!0),n.next=4,t();case 4:e(0),r(!1),n.next=11;break;case 8:n.prev=8,n.t0=n.catch(0),console.log(n.t0);case 11:case"end":return n.stop()}}),n,null,[[0,8]])})));return function(){return n.apply(this,arguments)}}();return Object(n.jsx)("header",{className:"fixed bg-secondary shadow-md  z-50 w-full px-5 py-2 flex justify-between items-center",children:Object(n.jsxs)("div",{className:"flex flex-row justify-items-auto align-middle",children:[Object(n.jsx)("p",{className:"justify-self-start align-middle items-center",children:"Torre"}),Object(n.jsx)("button",{className:"justify-self-end bg-primary ml-3 p-2 rounded-lg",onClick:a,children:"Logout"})]})})},A=r(7),B=r.n(A),W=function(e){return Object(n.jsx)("div",{className:"bg-secondary p-5 color-white ".concat(B.a.prsCard),children:Object(n.jsxs)("div",{className:"flex flex-col text-center content-center ".concat(B.a.inOn),children:[Object(n.jsx)("img",{src:e.picture,className:"object-contain h-28 w-full mb-5 ".concat(B.a.imga),alt:e.username}),Object(n.jsx)("p",{children:e.username}),Object(n.jsx)("p",{children:e.name})]})})},F=function(){var e=T().closePeople;return Object(n.jsxs)("main",{className:"flex h-screen w-screen bg-onTerceary font-sans text-white",children:[Object(n.jsx)(M,{}),Object(n.jsx)("div",{className:"mx-auto mt-16 flex flex-col",children:Object(n.jsx)("div",{className:"overflow-x-scroll flex flex-row w-screen",children:null===e||void 0===e?void 0:e.map((function(e,t){return Object(n.jsx)(W,{username:e.username,name:e.name,picture:e.picture},t)}))})})]})};var D=function(){var e=v().screen,t=w().globalLoading;return Object(n.jsxs)("div",{className:"App",children:[t&&Object(n.jsx)("div",{className:"absolute top-0 left-0 flex h-screen w-screen bg-opacity-50 bg-white",children:Object(n.jsx)("div",{className:"m-auto",children:Object(n.jsx)(_,{})})}),function(){switch(e){case 0:return Object(n.jsx)(L,{});case 1:return Object(n.jsx)(F,{});default:return null}}()]})},z=(r(17),function(e){e&&e instanceof Function&&r.e(3).then(r.bind(null,19)).then((function(t){var r=t.getCLS,n=t.getFID,a=t.getFCP,s=t.getLCP,c=t.getTTFB;r(e),n(e),a(e),s(e),c(e)}))});o.a.render(Object(n.jsx)(s.a.StrictMode,{children:Object(n.jsx)(O,{children:Object(n.jsx)(y,{children:Object(n.jsx)(C,{children:Object(n.jsx)(D,{})})})})}),document.getElementById("root")),z()},6:function(e,t,r){e.exports={basicInput:"AuthCard_basicInput__9N61l",continueButton:"AuthCard_continueButton__28Zlh",AuthCard:"AuthCard_AuthCard__21zaV"}},7:function(e,t,r){e.exports={prsCard:"PersonCard_prsCard__2sWbA",inOn:"PersonCard_inOn__2XC1S"}}},[[18,1,2]]]);
//# sourceMappingURL=main.c2afa7f0.chunk.js.map